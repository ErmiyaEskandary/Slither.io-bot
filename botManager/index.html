<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">

  <title>Slither.io botManager</title>
  <link href="./css/bootstrap.css" rel="stylesheet" type="text/css">
</head>

<body>
<!DOCTYPE html>
<html>
<head>
    <title>
    </title>
</head>

<body>
    <div class="container container-fluid">
        <div class="page-header">
            <h1>Slither.io botManager</h1>
        </div>


        <div class="row">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Add a variable to check for

                    <div class="input-group">
                        <input class="form-control" id="add-variable-text" placeholder="bot.isBotRunning" type=
                        "text"><span class="input-group-btn"><button class="btn btn-default" id="add-variable" type=
                        "button"><span class="input-group-btn">Add</span></button></span>
                    </div>
                </div>
                <!-- Table -->


                <table class="table" id="table-bots">
                    <thead>
                        <tr id="th-variables">
                            <td>
                            </td>
                        </tr>
                    </thead>


                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>

        <hr>


        <div class="row">
            <div class="input-group">
                <span class="input-group-btn">
                  <button class="btn btn-default" id="submit-code" type="button"><span class="input-group-btn">Run</span></button></span> 
                  <input class="form-control" id= "code-url" type="text" value="https://rawgit.com/ErmiyaEskandary/Slither.io-bot/master/bot.user.js">
            </div>
        </div>

        <br/>

        <div class="row">
            <button class="btn btn-default" id="update-stats">Update stats</button>
        </div>

        <hr>


        <footer>
            <p>Tool to test and create multiple instances of <a href=
            "https://github.com/ErmiyaEskandary/Slither.io-bot">ErmiyaEskandary's Slither.io bot</a>.</p>
        </footer>
    </div>
</body>
</html>

  <script>
    window.checkVariables = ['botUrl', 'bot.isBotRunning', 'bot.scores']
    // Require stuff :D
    window.$ = window.jQuery = require('./js/jquery-2.2.3.min.js');
    require('./renderer.js');
    require('./js/bootstrap.js');
    const {ipcRenderer} = require('electron');
  </script> 


  <script>
    $('#submit-code').click(function() {
        // maybe linting the code?
        args = {
            codeUrl: $('#code-url').val()
        };
        // Create a new bot window in main.js
        ipcRenderer.send('submit-code', args);
    })
    ipcRenderer.on('replyAllStats', (event, args) => {
        $('#table-bots tbody tr').remove();
        for (var i = 0; i < args.length; i++) {
            var current = args[i];
            console.log(current);
            $('#table-bots tbody').append($('<tr>'));
            var currentRow = $('#table-bots tbody tr:last-child');
            for (var j = 0; j < window.checkVariables.length; j++) {
                var currentVariable = window.checkVariables[j];
                currentRow.append($('<td>').text((eval('current.' + currentVariable))));
            }
        }
    });
    $('#update-stats').click(function() {
        ipcRenderer.send('getAllStats');
    })
    $('#add-variable').click(function() {
        window.checkVariables.push($('#add-variable-text').val());
        updateTableHead();
    })

    function updateTableHead() {
        $('#table-bots thead th').remove();
        for (var i = 0; i < window.checkVariables.length; i++) {
            var currentVariable = window.checkVariables[i];
            $('#th-variables').append($('<th>').text(currentVariable));
        }
    }
    $('document').ready(function() {
        updateTableHead();
    })
  </script>

</body>
</html>
